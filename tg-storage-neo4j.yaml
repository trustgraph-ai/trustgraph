"services":
  "etcd":
    "command":
    - "etcd"
    - "-advertise-client-urls=http://127.0.0.1:2379"
    - "-listen-client-urls"
    - "http://0.0.0.0:2379"
    - "--data-dir"
    - "/etcd"
    "deploy":
      "resources":
        "limits":
          "cpus": "1.0"
          "memory": "128M"
        "reservations":
          "cpus": "0.25"
          "memory": "128M"
    "environment":
      "ETCD_AUTO_COMPACTION_MODE": "revision"
      "ETCD_AUTO_COMPACTION_RETENTION": "1000"
      "ETCD_QUOTA_BACKEND_BYTES": "4294967296"
      "ETCD_SNAPSHOT_COUNT": "50000"
    "image": "quay.io/coreos/etcd:v3.5.15"
    "ports":
    - "2379:2379"
    "restart": "on-failure:100"
    "volumes":
    - "etcd:/etcd"
  "grafana":
    "deploy":
      "resources":
        "limits":
          "cpus": "1.0"
          "memory": "256M"
        "reservations":
          "cpus": "0.5"
          "memory": "256M"
    "environment":
      "GF_ORG_NAME": "trustgraph.ai"
    "image": "docker.io/grafana/grafana:11.1.4"
    "ports":
    - "3000:3000"
    "restart": "on-failure:100"
    "volumes":
    - "grafana-storage:/var/lib/grafana"
    - "./grafana/dashboard.yml:/etc/grafana/provisioning/dashboards/dashboard.yml"
    - "./grafana/datasource.yml:/etc/grafana/provisioning/datasources/datasource.yml"
    - "./grafana/dashboard.json:/var/lib/grafana/dashboards/dashboard.json"
  "init-pulsar":
    "command":
    - "sh"
    - "-c"
    - "pulsar-admin --admin-url http://pulsar:8080 tenants create tg && pulsar-admin --admin-url http://pulsar:8080 namespaces create tg/flow && pulsar-admin --admin-url http://pulsar:8080 namespaces create tg/request && pulsar-admin --admin-url http://pulsar:8080 namespaces create tg/response && pulsar-admin --admin-url http://pulsar:8080 namespaces set-retention --size -1 --time 3m tg/response"
    "depends_on":
      "pulsar":
        "condition": "service_started"
    "deploy":
      "resources":
        "limits":
          "cpus": "0.5"
          "memory": "128M"
        "reservations":
          "cpus": "0.1"
          "memory": "128M"
    "image": "docker.io/apachepulsar/pulsar:3.3.1"
    "restart": "on-failure:100"
  "milvus":
    "command":
    - "milvus"
    - "run"
    - "standalone"
    "deploy":
      "resources":
        "limits":
          "cpus": "1.0"
          "memory": "256M"
        "reservations":
          "cpus": "0.5"
          "memory": "256M"
    "environment":
      "ETCD_ENDPOINTS": "etcd:2379"
      "MINIO_ADDRESS": "minio:9000"
    "image": "docker.io/milvusdb/milvus:v2.4.9"
    "ports":
    - "9091:9091"
    - "19530:19530"
    "restart": "on-failure:100"
    "volumes":
    - "milvus:/var/lib/milvus"
  "minio":
    "command":
    - "minio"
    - "server"
    - "/minio_data"
    - "--console-address"
    - ":9001"
    "deploy":
      "resources":
        "limits":
          "cpus": "0.5"
          "memory": "128M"
        "reservations":
          "cpus": "0.25"
          "memory": "128M"
    "environment":
      "MINIO_ROOT_PASSWORD": "minioadmin"
      "MINIO_ROOT_USER": "minioadmin"
    "image": "docker.io/minio/minio:RELEASE.2024-08-17T01-24-54Z"
    "ports":
    - "9001:9001"
    "restart": "on-failure:100"
    "volumes":
    - "minio-data:/minio_data"
  "neo4j":
    "deploy":
      "resources":
        "limits":
          "cpus": "1.0"
          "memory": "768M"
        "reservations":
          "cpus": "0.5"
          "memory": "768M"
    "environment":
      "NEO4J_AUTH": "neo4j/password"
    "image": "docker.io/neo4j:5.22.0-community-bullseye"
    "ports":
    - "7474:7474"
    - "7687:7687"
    "restart": "on-failure:100"
    "volumes":
    - "neo4j:/data"
  "prometheus":
    "deploy":
      "resources":
        "limits":
          "cpus": "0.5"
          "memory": "128M"
        "reservations":
          "cpus": "0.1"
          "memory": "128M"
    "image": "docker.io/prom/prometheus:v2.53.2"
    "ports":
    - "9090:9090"
    "restart": "on-failure:100"
    "volumes":
    - "./prometheus:/etc/prometheus"
    - "prometheus-data:/prometheus"
  "pulsar":
    "command": "bin/pulsar standalone"
    "deploy":
      "resources":
        "limits":
          "cpus": "1.0"
          "memory": "900M"
        "reservations":
          "cpus": "0.5"
          "memory": "900M"
    "environment":
      "PULSAR_MEM": "-Xms700M -Xmx700M"
    "image": "docker.io/apachepulsar/pulsar:3.3.1"
    "ports":
    - "6650:6650"
    - "8080:8080"
    "restart": "on-failure:100"
    "volumes":
    - "pulsar-conf:/pulsar/conf"
    - "pulsar-data:/pulsar/data"
  "pulsar-manager":
    "deploy":
      "resources":
        "limits":
          "cpus": "0.5"
          "memory": "1.4G"
        "reservations":
          "cpus": "0.1"
          "memory": "1.4G"
    "environment":
      "SPRING_CONFIGURATION_FILE": "/pulsar-manager/pulsar-manager/application.properties"
    "image": "docker.io/apachepulsar/pulsar-manager:v0.4.0"
    "ports":
    - "9527:9527"
    - "7750:7750"
    "restart": "on-failure:100"
  "query-graph-embeddings":
    "command":
    - "ge-query-milvus"
    - "-p"
    - "pulsar://pulsar:6650"
    - "-t"
    - "http://milvus:19530"
    "deploy":
      "resources":
        "limits":
          "cpus": "0.5"
          "memory": "128M"
        "reservations":
          "cpus": "0.1"
          "memory": "128M"
    "image": "docker.io/trustgraph/trustgraph-flow:0.7.13"
    "restart": "on-failure:100"
  "query-triples":
    "command":
    - "triples-query-neo4j"
    - "-p"
    - "pulsar://pulsar:6650"
    - "-g"
    - "bolt://neo4j:7687"
    "deploy":
      "resources":
        "limits":
          "cpus": "0.5"
          "memory": "128M"
        "reservations":
          "cpus": "0.1"
          "memory": "128M"
    "image": "docker.io/trustgraph/trustgraph-flow:0.7.13"
    "restart": "on-failure:100"
  "store-graph-embeddings":
    "command":
    - "ge-write-milvus"
    - "-p"
    - "pulsar://pulsar:6650"
    - "-t"
    - "http://milvus:19530"
    "deploy":
      "resources":
        "limits":
          "cpus": "0.5"
          "memory": "128M"
        "reservations":
          "cpus": "0.1"
          "memory": "128M"
    "image": "docker.io/trustgraph/trustgraph-flow:0.7.13"
    "restart": "on-failure:100"
  "store-triples":
    "command":
    - "triples-write-neo4j"
    - "-p"
    - "pulsar://pulsar:6650"
    - "-g"
    - "bolt://neo4j:7687"
    "deploy":
      "resources":
        "limits":
          "cpus": "0.5"
          "memory": "128M"
        "reservations":
          "cpus": "0.1"
          "memory": "128M"
    "image": "docker.io/trustgraph/trustgraph-flow:0.7.13"
    "restart": "on-failure:100"
"volumes":
  "etcd": {}
  "grafana-storage": {}
  "milvus": {}
  "minio-data": {}
  "neo4j": {}
  "prometheus-data": {}
  "pulsar-conf": {}
  "pulsar-data": {}
